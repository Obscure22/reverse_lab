<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obscure RE and MA Dojo</title>
    
    <!-- link to fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- link to css file -->
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
      <a href="/obscure_blog" class="logo">Obscure_</a>
          <ul class="nav-links">
              <li><a href="../re.html">CTF Reverse Engineering</a></li>
          </ul>
    </nav>
    <section class="container">
        <section class="container-title">
            <h1>0x41haz - TryHackMe</h1>
            <div class="post__bottom">
                <div class="post__author">
                    <a href="#" aria-label="ObscureRe">
                        <img class="post__author-image" src="../../img/logo.png"
                            alt="Obscure's Picture">
                    </a>
                </div>
                <span>
                    Obscure_ &nbsp;·&nbsp; <span id="reading-time"></span>
                </span>
            </div>
        </section>
        <section>
            <h2>Introduction</h2>
            <p>
                This write-up covers the <strong>0x41haz</strong> challenge from <strong>TryHackMe</strong>. Time to roll up our sleeves and start reversing.
            </p>
        </section>
        <section>
            <h2>Analysis</h2>
                <p>
                    The first and most straightforward step is to execute the program. It immediately prompts the user to enter a password. Since the correct password is not yet known, a test 
                    value such as <strong>test</strong> can be provided, which results in the expected outcome: the password is incorrect.

                    <img class="post-image" src="../../img/re_0x41haz/0x41haz_1.png" alt="0x41haz_1" onclick="window.open(this.src, '_blank');">

                    Opening the binary in <strong>IDA</strong> shows the initial code at the program entry point, as illustrated in the figure below. From this, it is possible to observe that the 
                    execution has not yet reached the main function. The address of main is later loaded into the <span id="inline-code">rdi</span> register, and a call instruction is executed 
                    to transfer control to the program’s main function.

                    <img class="post-image" src="../../img/re_0x41haz/0x41haz_2.png" alt="0x41haz_2" onclick="window.open(this.src, '_blank');">

                    The figure below shows the main function. One of the first things to notice is that some hexadecimal values are pushed onto the stack. The program then calls multiple 
                    <span id="inline-code">puts</span> functions, one of which prompts the user to enter a password.
                    <br>
                    After the password is entered, it is stored on the stack at <span id="inline-code">ebp+s</span>, and its address is then moved into <span id="inline-code">rax</span>. 
                    The function <span id="inline-code">strlen</span> is then called to compute the length of the input string. This length is compared with the value <span id="inline-code">0x0D</span>
                    (13). If the result of the comparison is not zero, meaning the string is not exactly 13 characters long, the execution follows the left branch and the program terminates.

                    <img class="post-image" src="../../img/re_0x41haz/0x41haz_3.png" alt="0x41haz_3" onclick="window.open(this.src, '_blank');">

                    In this way, it is possible to determine that the password must be 13 characters long. In fact, if the program is executed and, for example, 13 'A' characters are provided as 
                    input, a different output is produced. This indicates that the execution has followed the right branch of the program.

                    <img class="post-image" src="../../img/re_0x41haz/0x41haz_4.png" alt="0x41haz_4" onclick="window.open(this.src, '_blank');">
                </p>
        </section>
    </section>

    <script src="../../js/reading-time.js"></script>
</body>
</html>
